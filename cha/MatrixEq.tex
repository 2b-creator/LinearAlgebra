\chapter{初等矩阵}
\begin{center}
	% \textcolor[RGB]{255, 0, 0}{\faHeart}所以生命啊，它苦涩如歌.\textcolor[RGB]{255, 0, 0}{\faHeart}
	「只愿君心似我心，定不负相思意」
\end{center}
\rightline{——《卜算子$\cdot$我住长江头》}
\vspace{-5pt}
\begin{center}
	\pgfornament[width=0.36\linewidth,color=lsp]{88}
\end{center}

\section{线性方程组的解}

\subsection{二元线性方程组}

考虑一般的二元线性方程组\begin{numcases}{}
	a_{11}x_1+a_{12}x_2=b_1 \label{eq:1-1}\\
	a_{21}x_1+a_{22}x_2=b_2 \label{eq:1-2}
\end{numcases}按照正常的方法，我们将式\ref{eq:1-1}乘系数$a_{21}$，将\ref{eq:1-2}乘系数$a_{11}$后，用变换过的\ref{eq:1-1}减去\ref{eq:1-2}后我们可以得到$$\left( a_{11}a_{22}-a_{12}a_{21} \right)x_1=b_1a_{22}-b_2a_{12}$$我们可以得到方程的解$$x_1=\frac{\begin{vmatrix}
	b_1 & a_{12}\\
	b_2 & a_{22}
\end{vmatrix}}{\begin{vmatrix}
	a_{11} & a_{12}\\
	a_{21} & a_{22}
\end{vmatrix}}$$通过上述方法，我们可以得到$$x_2=\frac{\begin{vmatrix}
	a_{11} & b_1\\
	a_{21} & b_2
\end{vmatrix}}{\begin{vmatrix}
	a_{11} & a_{12}\\
	a_{21} & a_{22}
\end{vmatrix}}$$

\subsection{Cramer 法则}

以上面的二元线性方程组为例我们抽象出的两个解的表示方法，其中我们有系数矩阵行列式$$\mathbf{D}=\begin{vmatrix}
	a_{11} & a_{12}\\
	a_{21} & a_{22}
\end{vmatrix}$$其中常数矩阵$\mathbf{B}=\begin{pmatrix}
	b_1\\
	b_2
\end{pmatrix}$，我们将常数矩阵替换系数矩阵的第$i$列，得到$\mathbf{D}_i$行列式，例如$$\mathbf{D}_1=\begin{vmatrix}
	b_1 &a_{12}\\
	b_2 &a_{22}
   \end{vmatrix},\mathbf{D}_2=\begin{vmatrix}
	a_{11} & b_1 \\
	a_{12} & b_2
\end{vmatrix}$$最后方程组的第$i$个解为$$x_i=\frac{\mathbf{D}_i}{\mathbf{D}}$$

\begin{example}
	使用Cramer法则计算线性方程组$$\left\{\begin{matrix} 
		2x+3y+4z =3 \\  
		5x+4z=2\\
		x+3y+z=1
	  \end{matrix}\right. $$
	  \tcblower
	  \textcolor{purple}{\textbf{解}}：考虑系数矩阵行列式$$\mathbf{D}=\begin{vmatrix}
		2 & 3 & 4\\
		5 & 0 & 4\\
		1 & 3 & 1
	   \end{vmatrix}=33$$常数矩阵$$\mathbf{B}=\begin{pmatrix}
		3 \\
		2 \\
		1
		\end{pmatrix}$$使用常数矩阵替换行列式的第$i$列，我们可以得到$$\mathbf{D}_1=\begin{vmatrix}
			3 & 3 & 4\\
			2 & 0 & 4\\
			1 & 3 & 1
		   \end{vmatrix}=-6,\mathbf{D}_2=\begin{vmatrix}
			2 & 3 & 4\\
			5 & 2 & 4\\
			1 & 1 & 1
		   \end{vmatrix}=5,\mathbf{D}_3=\begin{vmatrix}
			2 & 3 & 3\\
			5 & 0 & 2\\
			1 & 3 & 1
		   \end{vmatrix}=24$$那么该方程组的三个解分别为$$x_1=\frac{\mathbf{D}_1}{\mathbf{D}}=-\frac{2}{11},x_2=\frac{\mathbf{D}_2}{\mathbf{D}}=\frac{5}{33},x_3=\frac{\mathbf{D}_3}{\mathbf{D}}=-\frac{8}{11}$$
\end{example}

\begin{ascolorbox1}{思考}
	当系数矩阵的行列式$\mathbf{D}=0$时是什么情况？
\end{ascolorbox1}

Cramer 法则的适用前提是系数矩阵的行列式值不能为0，读者可以发现若系数矩阵的行列式为0的时候会有一组方程组线性相关，其所面临的情况为有无穷多解或无解，例如$$\left\{\begin{matrix} 
	2x_1+3x_2 = 4 \\  
	4x_1+6x_2 = 8
  \end{matrix}\right. $$这种情况就是无穷多解，而$$\left\{\begin{matrix} 
	2x_1+3x_2 = 4 \\  
	4x_1+6x_2 = 9
  \end{matrix}\right. $$则是无解。

\subsection{齐次线性方程组}

\label{subsec:homogeneous}

齐次线性方程组是线性方程组中的一个特例，定义如下
\begin{definition}{齐次线性方程组(homogeneous linear equations)}
	齐次线性方程组指的是常数项全部为零的线性方程组，它们一般记作$$\left\{\begin{matrix} 
		a_{11}x_1+a_{12}x_2+a_{13}x_3+\cdots+a_{1n}x_n=0 \\  
		a_{21}x_1+a_{22}x_2+a_{23}x_3+\cdots+a_{2n}x_n=0 \\  
		a_{31}x_1+a_{32}x_2+a_{33}x_3+\cdots+a_{3n}x_n=0 \\
		\cdots \\
		a_{m1}x_1+a_{m2}x_2+a_{m3}x_3+\cdots+a_{mn}x_n=0
	  \end{matrix}\right. $$
\end{definition}

我们在第2章的B组练习中有提到这种方程组，先说结论，当$n>m$的时候齐次线性方程组必有非零解，在练习中，我们使用线性映射$$T(x_1,x_2,\cdots,x_n)=\left( \sum_{i=1}^{n}a_{1i}x_i,\sum_{i=1}^{n}a_{2i}x_i,\cdots,\sum_{i=1}^{n}a_{mi}x_i \right)$$这里的线性映射$T$将$\mathbb{F}^n$映射为$\mathbb{F}^m$，根据线性映射的基本定理有$$\text{dim}\mathbb{F}^n=\text{dim}~\text{null}T+\text{dim}~\text{range}T$$使得齐次线性方程组有无穷多解的充要条件是$T$不是单射；所以$\text{null}T\neq \left\{ 0 \right\}$(否则对应映射到零空间的向量只有$\boldsymbol{0}$)。

接下来我们考虑特殊的情况，当$m=n$的时候，系数矩阵的行列式$\mathbf{D}=\begin{vmatrix}  
	a_{11}& a_{12}& \cdots  & a_{1n} \\  
	a_{21}& a_{22}& \cdots  & a_{2n} \\  
	\vdots & \vdots & \ddots & \vdots \\  
	a_{m1}& a_{m2}& \cdots  & a_{mn}  
  \end{vmatrix}  
$如果我们对其使用 Cramer 法则，当$\mathbf{D}\neq 0$时，$\displaystyle x_i=\frac{\mathbf{D}_i}{\mathbf{D}}=0$有且仅有全为0解，即$x_1=x_2=\cdots=x_n=0$。那如果$\mathbf{D}= 0$则系数矩阵的几行向量线性相关，根据线性相关的向量可以通过去除$i$个向量可以得到线性无关的向量，由于$m=n,m-i<n$，所以我们得到齐次线性方程组有无穷多解。

\section{初等矩阵}

\subsection{增广矩阵}

%cite
首先需要注意的是，按照初等矩阵的定义，增广矩阵不算是初等矩阵的一种，但是因为它可以使用矩阵的初等行变化，所以笔者将其纳入初等矩阵这一节。

考虑线性方程组$$\left\{\begin{matrix} 
	a_{11}x_1+a_{12}x_2+a_{13}x_3+\cdots+a_{1n}x_n=b_1 \\  
	a_{21}x_1+a_{22}x_2+a_{23}x_3+\cdots+a_{2n}x_n=b_2 \\  
	a_{31}x_1+a_{32}x_2+a_{33}x_3+\cdots+a_{3n}x_n=b_3 \\
	\cdots \\
	a_{m1}x_1+a_{m2}x_2+a_{m3}x_3+\cdots+a_{mn}x_n=b_m
\end{matrix}\right. $$在系数矩阵的右边添上一列，这一列是线性方程组的等号右边的值，构成增广矩阵，记作$\tilde{\mathbf{A} } $

\begin{definition}{增广矩阵(augmented matrix)}
	线性方程组$$\left\{\begin{matrix} 
		a_{11}x_1+a_{12}x_2+a_{13}x_3+\cdots+a_{1n}x_n=b_1 \\  
		a_{21}x_1+a_{22}x_2+a_{23}x_3+\cdots+a_{2n}x_n=b_2 \\  
		a_{31}x_1+a_{32}x_2+a_{33}x_3+\cdots+a_{3n}x_n=b_3 \\
		\cdots \\
		a_{m1}x_1+a_{m2}x_2+a_{m3}x_3+\cdots+a_{mn}x_n=b_m
	\end{matrix}\right. $$其系数构成一个矩阵后在最后一列添加系数矩阵，记作$\tilde{\mathbf{A}}$，即$$\tilde{\mathbf{A}}:=\begin{pmatrix}  
		a_{11}& a_{12}& \cdots  & a_{1n} & b_1 \\  
		a_{21}& a_{22}& \cdots  & a_{2n} & b_2\\  
		\vdots & \vdots & \ddots & \vdots \\  
		a_{m1}& a_{m2}& \cdots  & a_{mn} & b_m
	  \end{pmatrix}  
	  $$
\end{definition}

通过增广矩阵的初等变换，我们可以求解线性方程组，通常这个方法叫做高斯消元法，接下里我们看一个例子：

\begin{example}
	写出线性方程组$$\left\{\begin{matrix} 
		x+y+z=4 \\  
		2x+4y+5z=16 \\
		x+5y-3z=0
	\end{matrix}\right. $$的增广矩阵
	\tcblower
	\textcolor{purple}{\textbf{解}}：见下讲解
\end{example}

我们提取该方程组的增广矩阵，即$$\tilde{A}=\begin{pmatrix}
	1 & 1 & 1 & 4\\
	2 & 4 & 5 & 16\\
	1 & 5 & -3 & 0
\end{pmatrix}$$应用矩阵的初等\textcolor{red}{行}变换就可以求解该线性方程组，下面先讲解一下什么是矩阵的初等变换。

\subsection{矩阵的初等变换}

首先为了说明变换后的矩阵和原矩阵的关系，我们使用``等价''来描述它们，需要注意的是，它们通常并不相等。设矩阵$\mathbf{A}$经过初等变换后变为$\mathbf{A}'$，则$\mathbf{A}$与$\mathbf{A}'$等价，记作$$\mathbf{A}\Longrightarrow  \mathbf{A}'$$如无特殊说明，我们这里都使用初等行变换，实际上对矩阵的列进行变换操作在某些情况下也是等价的。

\subsubsection{交换两行}

交换两行是矩阵的初等变换，例如$$\begin{pmatrix}
	1 & 3 & 3 & 3\\
\textcolor{blue}{2} & \textcolor{blue}{2} & \textcolor{blue}{2} & \textcolor{blue}{1}\\
	\textcolor{red}{4} & \textcolor{red}{2} & \textcolor{red}{1} & \textcolor{red}{3}
\end{pmatrix}\Longrightarrow \begin{pmatrix}
	1 & 3 & 3 & 3\\
	\textcolor{red}{4} & \textcolor{red}{2} & \textcolor{red}{1} & \textcolor{red}{3}\\
	\textcolor{blue}{2} & \textcolor{blue}{2} & \textcolor{blue}{2} & \textcolor{blue}{1}
\end{pmatrix}$$

\subsection{某一行乘以常数k}

某一行乘以常数$k$是矩阵的初等变换，例如$$\begin{pmatrix}
	1 & 2 & 3 & 1\\
	\textcolor{red}{4} & \textcolor{red}{2} & \textcolor{red}{1} & \textcolor{red}{2}\\
	2 & 2 & 2 & 1
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 2 & 3 & 1\\
	\textcolor{red}{4k} & \textcolor{red}{2k} & \textcolor{red}{k} & \textcolor{red}{2k}\\
	2 & 2 & 2 & 1
\end{pmatrix},k\in \mathbb{C}$$

\subsection{某个数乘以某一行并加到另一行中去}

某个数乘以某一行并加到另一行中去是矩阵的初等变换，例如$$\begin{pmatrix}
	\textcolor{red}{1} & \textcolor{red}{2} & \textcolor{red}{3} & \textcolor{red}{4}\\
	1 & 2 & 2 & 4\\
	2 & 3 & 4 & 5\\
	4 & 5 & 6 & 7
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	\textcolor{red}{1} & \textcolor{red}{2} & \textcolor{red}{3} & \textcolor{red}{4}\\
	1 & 2 & 2 & 4\\
	2+\textcolor{red}{2} & 3+\textcolor{red}{4} & 4+\textcolor{red}{6} & 5+\textcolor{red}{8}\\
	4 & 5 & 6 & 7
\end{pmatrix}$$

\subsubsection{最简矩阵}

矩阵经过一定的初等变换，可化简为最简矩阵，在给出最简矩阵的定义之前，先给出一个术语来描述一个特定行。

\begin{definition}{零行}
	矩阵的某一行均为0，则称这一行为为零行，否则为非零行。
\end{definition}

下面给出行阶梯矩阵与最简矩阵的定义。

\begin{definition}{行阶梯形矩阵与最简矩阵}
	非零矩阵若满足，非零行在零行的上面，且非零行的首个非零元素在列的上一行(如果存在的话)的首个非零元素所在列的后面，例如下面一个就是行阶梯形矩阵\footnote{如红色标出的0元素，像一个阶梯一样从左往右下降}$$\mathbf{A}=\begin{pmatrix}
		1 & 0 & 4 & 1 & 2 & 3\\
		\textcolor{red}{0} & 1 & 3 & 5 & 0 & 3\\
		\textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & 2 & 3 & 7\\
		\textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0}
	\end{pmatrix}$$
	特别地，当行阶梯形矩阵的每一行第一个非零元素，例如$$\begin{pmatrix}
		\textcolor{blue}{1} & 0 & 4 & 1 & 2 & 3\\
		\textcolor{red}{0} & \textcolor{blue}{1} & 3 & 5 & 0 & 3\\
		\textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & \textcolor{blue}{1} & 3 & 7\\
		\textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0} & \textcolor{red}{0}
	\end{pmatrix}$$我们称这个矩阵为最简矩阵\footnote{最简矩阵一般指的是最简行矩阵，如果是列最简，我们会明确说明是``列最简矩阵''}。
\end{definition}

\begin{corollary}
	任何矩阵经过有限次的行变换都可以转化为最简矩阵。
\end{corollary}

\subsection{高斯消元法}

线性方程组的增广矩阵可以由行变换变为最简行矩阵，通常可用于解无法使用Cramer法则的线性方程组\footnote{斋藤正彦在它的著作《线性代数入门》这本书中，讲到了有位计算机学家告诉他，Cramer法则不适合用于大量行列式的数值计算，相比之下高斯消元法更好}，这种方法叫做高斯消元法。

首先看线性方程组有唯一解的情况，即在Cramer法则下系数矩阵的行列式值不为0，下面是一个例子$$\left\{\begin{matrix} 
	x+y+z=4 \\  
	2x+4y+5z=16 \\
	x+5y-3z=0
\end{matrix}\right. $$我们提取该方程组的增广矩阵为$$\tilde{\mathbf{A}}=\begin{pmatrix}
	1 & 1 & 1 & 4\\
	2 & 4 & 5 & 16\\
	1 & 5 & -3 & 0
\end{pmatrix}$$将其变化为行阶梯矩阵，首先将第1行乘以$-2$加到第2行，我们可得等价矩阵$$\begin{pmatrix}
	1 & 1 & 1 & 4\\
	2 & 4 & 5 & 16\\
	1 & 5 & -3 & 0
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 1 & 1 & 4\\
	0 & 2 & 3 & 8\\
	1 & 5 & -3 & 0
\end{pmatrix}$$将第1行乘以$-1$加到第3行，我们继续可得等价矩阵$$\begin{pmatrix}
	1 & 1 & 1 & 4\\
	0 & 2 & 3 & 8\\
	1 & 5 & -3 & 0
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 1 & 1 & 4\\
	0 & 2 & 3 & 8\\
	0 & 4 & -4 & -4
\end{pmatrix}$$将第3行除以$-2$加到第2行后，交换2，3两行我们继续可得等价矩阵$$\begin{pmatrix}
	1 & 1 & 1 & 4\\
	0 & 2 & 3 & 8\\
	0 & 4 & -4 & -4
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 1 & 1 & 4\\
	0 & -2 & 2 & 2\\
	0 & 0 & 5 & 10
\end{pmatrix}$$最后将第2行除以$-2$，第3行除以5可得矩阵$$\begin{pmatrix}
	1 & 1 & 1 & 4\\
	0 & -2 & 2 & 2\\
	0 & 0 & 5 & 10
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 1 & 1 & 4\\
	0 & 1 & -1 & -1\\
	0 & 0 & 1 & 2
\end{pmatrix}$$如果我们重写为方程组即$$\left\{\begin{aligned} 
	x+y+z&=4 \\  
	y-z&=-1\\
	z&=2
\end{aligned}\right. $$

将结果逐个带入线性方程组，可得$x=1,y=1,z=2$。下面我们给出线性方程组有无穷个解的情况。

\begin{example}
	使用高斯消元法求解线性方程组$$\left\{\begin{matrix} 
	x+2y+4z=2 \\  
	2x+y-z=1\\
	x+y+z=1
\end{matrix}\right. $$
\tcblower
\textcolor{purple}{\textbf{解}}：$x=3z,y=1-3z,z=z$见下讲解
\end{example}

我们提取该方程组的增广矩阵为$$\tilde{\mathbf{A}}=\begin{pmatrix}
	1 & 2 & 4 & 2\\
	2 & 1 & -1 & 1\\
	1 & 1 & 1 & 1
\end{pmatrix}$$首先讲第3行乘以3，我们可得$$\begin{pmatrix}
	1 & 2 & 4 & 2\\
	2 & 1 & -1 & 1\\
	1 & 1 & 1 & 1
   \end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 2 & 4 & 2\\
	2 & 1 & -1 & 1\\
	3 & 3 & 3 & 3
\end{pmatrix}$$其次将第1，2行乘以$-1$后依次加到第三行可得$$\begin{pmatrix}
	1 & 2 & 4 & 2\\
	2 & 1 & -1 & 1\\
	3 & 3 & 3 & 3
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 2 & 4 & 2\\
	2 & 1 & -1 & 1\\
	0 & 0 & 0 & 0
\end{pmatrix}$$最后将第1行乘以$-2$加到第2行，第2行除以$-3$得到$$\begin{pmatrix}
	1 & 2 & 4 & 2\\
	2 & 1 & -1 & 1\\
	0 & 0 & 0 & 0
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & 2 & 4 & 2\\
	0 & 1 & 3 & 1\\
	0 & 0 & 0 & 0
\end{pmatrix}$$如果我们重写为方程组即$$\left\{\begin{aligned} 
	x+2y+4z&=2 \\  
	y+3z&=1
\end{aligned}\right. $$由此我们可以知道该方程组有无穷个解，我们令线性无关组$z=z$其他的量均可使用$z$来表示，那么回代后可得$y=1-3z,x=2z$；至于更多复杂的方程组，读者可使用https://matrixcalc.org/zh-CN/slu.html页面求解。

\section{矩阵的逆}

\subsection{单位矩阵}

首先我们来看单位矩阵的定义；

\begin{definition}{单位矩阵}
	设$n\times n$矩阵的主对角线的元素均为1，则称该矩阵为$n$阶单位矩阵，简称单位矩阵，写作$\mathbf{I}$，即$$\mathbf{I}:=\begin{pmatrix}
		1 & 0 & \cdots & 0\\
		0 & 1 & \cdots & 0\\
		\vdots & \vdots & \ddots & \vdots\\
		0 & 0 & \cdots & 1
	   \end{pmatrix}$$
\end{definition}

那么对于$n$阶方阵$\mathbf{A}$，我们有下述推论成立：
\begin{corollary}
	若$\mathbf{A}$为$n$阶方阵，$\mathbf{I}$是单位矩阵，则有$$\mathbf{A}\mathbf{I}=\mathbf{I}\mathbf{A}=\mathbf{A}$$成立
\end{corollary}

请读者举例验证上述式子成立，不作严格证明；单位矩阵由于其相乘不变性，通常用于矩阵乘法逆元的计算，即求解逆矩阵。

\subsection{逆矩阵}

首先看逆矩阵的定义。

\begin{definition}{逆矩阵}
	设$\mathbf{A}$是一个$n$阶方阵，若存在另一个$n$阶方阵$\mathbf{B}$使得$$\mathbf{A}\mathbf{B}=\mathbf{B}\mathbf{A}=\mathbf{I}$$成立，则称$\mathbf{B}$为$\mathbf{A}$的逆矩阵，记作$\mathbf{A}^{-1}$所以$$\mathbf{A}\mathbf{A}^{-1}=\mathbf{I}$$
\end{definition}

关于逆矩阵存在下述推论

\begin{corollary}
	\begin{enumerate}
		\item 若$\mathbf{A}$可逆，则$\mathbf{A}^{-1}$也可逆且$\left( \mathbf{A}^{-1} \right)^{-1}=\mathbf{A}$。
		\item 若矩阵$\mathbf{A}_1,\mathbf{A}_2,\cdots,\mathbf{A}_s$均可逆，则它们乘积$\mathbf{A}_1\mathbf{A}_2\cdots\mathbf{A}_s$也可逆，并且满足$$\left( \mathbf{A}_1\mathbf{A}_2\cdots\mathbf{A}_s \right)^{-1}=\mathbf{A}_s^{-1}\cdots\mathbf{A}_2^{-1}\mathbf{A}_1^{-1}$$
		\item 若$\mathbf{A}$可逆，则$\mathbf{A}^T$也可逆，并且$\left( \mathbf{A}^T \right)^{-1}=\left( \mathbf{A}^{-1} \right)^T$。
		\item 若$\mathbf{A}$可逆且$k\neq 0$那么有$(k\mathbf{A})^{-1}=k^{-1}\mathbf{A}^{-1}$。
		\item 若$\mathbf{A}$可逆则$\det \mathbf{A}\neq 0$。
	\end{enumerate}
\end{corollary}

上述性质我们在此不作严格证明，我们仅描述使用相关方法来求逆矩阵；通常来说，求解逆矩阵可以帮助我们求解关于矩阵的方程。

\subsection{初等变换求逆矩阵}

由单位矩阵经过一次初等变换得到的矩阵称为初等矩阵，所以初等矩阵一般为 $n$ 阶方阵。而初等行变换则可以表示为有一个矩阵左乘另一个矩阵变化得来，例如交换两行$$\begin{pmatrix}
	3 & 2 & 1\\
	1 & -2 & 1\\
	3 & 5 & 0
\end{pmatrix}\Longrightarrow  \begin{pmatrix}
	1 & -2 & 1\\
	3 & 2 & 1\\
	3 & 5 & 0
\end{pmatrix}$$右边的矩阵可以由左边的矩阵左乘一个矩阵$\mathbf{P}$得到，其中$\mathbf{P}=\begin{pmatrix}
	0 & 1 & 0\\
	1 & 0 & 0\\
	0 & 0 & 1
\end{pmatrix}$那么根据这个性质，$\mathbf{A}$ 可以通过$n$次初等行变换，转化为单位矩阵，即存在矩阵$\mathbf{P}_1,\mathbf{P}_2,\cdots,\mathbf{P}_s$使得$\mathbf{P}_s,\cdots,\mathbf{P}_2\mathbf{P}_1\mathbf{A}=\mathbf{I}$所以$\mathbf{A}^{-1}=\mathbf{P}_s\cdots\mathbf{P}_2\mathbf{P}_1$，然后可以转化为单位矩阵，单位矩阵继续进行该过程，可以得到逆矩阵。

接下来我们讲解逆矩阵的求法，考虑$n$阶方阵$\mathbf{A}=\begin{pmatrix}
	2 & 3 & -2\\
	0 & 3 & 4\\
	1 & 1 & 1
\end{pmatrix}$，我们使用分块矩阵 $$\left( \begin{array}{c|c}
	\mathbf{A} & \mathbf{I}
\end{array} \right)=\left( \begin{array}{ccc|ccc}
	2 & 3 & -2 & 1 & 0 & 0\\
	0 & 3 & 4 & 0 & 1 & 0\\
	1 & 1 & 1 & 0 & 0 & 1
\end{array} \right)$$并对其施加初等行变化将左侧矩阵化为单位矩阵时，右侧矩阵即为逆矩阵，下面是相关过程：首先第一行乘以$\displaystyle \frac{1}{2}$可得
$$
\left( \begin{array}{ccc|ccc}
	2 & 3 & -2 & 1 & 0 & 0\\
	0 & 3 & 4 & 0 & 1 & 0\\
	1 & 1 & 1 & 0 & 0 & 1
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 3 & 4 & 0 & 1 & 0\\
	1 & 1 & 1 & 0 & 0 & 1
\end{array} \right)
$$再将第1行乘以$-1$加到第三行可得$$\left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 3 & 4 & 0 & 1 & 0\\
	1 & 1 & 1 & 0 & 0 & 1
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 3 & 4 & 0 & 1 & 0\\
	0 & -\frac{1}{2} & 2 & -\frac{1}{2} & 0 & 1
\end{array} \right)$$将第2行乘以$\displaystyle \frac{1}{3}$可得$$\left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 3 & 4 & 0 & 1 & 0\\
	0 & -\frac{1}{2} & 2 & -\frac{1}{2} & 0 & 1
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & \frac{4}{3} & 0 & \frac{1}{3} & 0\\
	0 & -\frac{1}{2} & 2 & -\frac{1}{2} & 0 & 1
\end{array} \right)$$将第2行乘以$\frac{1}{2}$后加到第三行可得$$\left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & \frac{4}{3} & 0 & \frac{1}{3} & 0\\
	0 & -\frac{1}{2} & 2 & -\frac{1}{2} & 0 & 1
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & \frac{4}{3} & 0 & \frac{1}{3} & 0\\
	0 & 0 & \frac{8}{3} & -\frac{1}{2} & \frac{1}{6} & 1
\end{array} \right)$$将第3行乘以$\displaystyle \frac{3}{8}$可得$$\left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & \frac{4}{3} & 0 & \frac{1}{3} & 0\\
	0 & 0 & \frac{8}{3} & -\frac{1}{2} & \frac{1}{6} & 1
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & \frac{4}{3} & 0 & \frac{1}{3} & 0\\
	0 & 0 & 1 & -\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)$$再将第3行乘以$\displaystyle -\frac{4}{3}$后加到第2行可得$$\left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & \frac{4}{3} & 0 & \frac{1}{3} & 0\\
	0 & 0 & 1 & -\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & 0 & \frac{1}{4} & \frac{1}{4} & -\frac{1}{2}\\
	0 & 0 & 1 & -\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)$$将第3行加到第1行可得$$\left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & -1 & \frac{1}{2} & 0 & 0\\
	0 & 1 & 0 & \frac{1}{4} & \frac{1}{4} & -\frac{1}{2}\\
	0 & 0 & 1 & -\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & 0 & \frac{5}{16} & \frac{1}{16} & \frac{3}{8}\\
	0 & 1 & 0 & \frac{1}{4} & \frac{1}{4} & -\frac{1}{2}\\
	0 & 0 & 1 & -\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)$$最后将第3行乘以$\displaystyle -\frac{3}{2}$加到第1行可得$$\left( \begin{array}{ccc|ccc}
	1 & \frac{3}{2} & 0 & \frac{5}{16} & \frac{1}{16} & \frac{3}{8}\\
	0 & 1 & 0 & \frac{1}{4} & \frac{1}{4} & -\frac{1}{2}\\
	0 & 0 & 1 & -\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)\Longrightarrow  \left( \begin{array}{ccc|ccc}
	1 & 0 & 0 & -\frac{1}{16} & -\frac{5}{16} & \frac{9}{8}\\
	0 & 1 & 0 & \frac{1}{4} & \frac{1}{4} & -\frac{1}{2}\\
	0 & 0 & 1 & -\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)$$所以矩阵变更为$\left( \mathbf{I} \mid \mathbf{A}^{-1} \right)$，得到$\mathbf{A}^{-1}=\left( \begin{array}{ccc}
	-\frac{1}{16} & -\frac{5}{16} & \frac{9}{8}\\
	\frac{1}{4} & \frac{1}{4} & -\frac{1}{2}\\
	-\frac{3}{16} & \frac{1}{16} & \frac{3}{8}
\end{array} \right)$

\section{矩阵的秩}

\subsection{极大线性无关组}

\label{subsec:preRank}

接下来请读者回顾一下\ref{subsec:LinearDependence}相关的内容，如果向量集合$S=\left\{ \alpha_1,\alpha_2,\cdots,\alpha_n \right\}$线性无关，其中向量$\beta$可以由$S$的线性组合得到，那么存在唯一的$k_1,k_2,\cdots,k_n\in \mathbb{F}$使得$\beta=k_1\alpha_1+k_2\alpha_2+\cdots+k_n\alpha_n$成立，如果$S$线性相关，则需要去除一些向量使得其线性无关这样就可以做到$k_1,k_2,\cdots,k_n\in \mathbb{F}$唯一。

由此我们引入极大线性无关组的概念：

\begin{definition}{极大线性无关组}
	设向量组\footnote{这里的组更偏向于组合而不是元组的意思，可以将其理解为向量集合的另一个称谓，因为从一个集合内选取的组合同时满足1.无序性，2.唯一性，3.确定性}$S=\left\{ \alpha_1,\alpha_2,\alpha_3,\cdots,\alpha_s \right\}$中选取$r$个向量，构成集合$S_r=\left\{ \beta_1,\beta_2,\beta_3,\cdots,\beta_r \right\}$满足:\begin{enumerate}
		\item $S_r$线性无关；
		\item 若从$S$中再选取一个$\alpha_i$到$S_r'$，则$S_r'$一定线性相关。
	\end{enumerate}
	我们称$S_r$为$S$的极大线性无关组。
\end{definition}

例如前面讲到的在三维空间$\mathbb{R}^3$中，极大线性无关组中向量个数最多为 3，例如\\$S=\left\{ (1,1,1),(1,1,2),(1,5,3),(2,3,3) \right\}$可以选取3个线性无关的向量作为基底表示第4个向量，而极端情况$S=\left\{(1,1,1),(2,2,2),(3,3,3),(4,4,4)\right\}$则极大线性无关组中向量个数1。

此外我们有如下推论：

\begin{corollary}
	\label{cor:indep}
	向量组$S$张成空间$\text{Span}(S)$等于其极大线性无关组$S_r$张成空间$\text{Span}(S_r)$。
\end{corollary}

\begin{proof}
	首先由于$ S_r $是$ S $的一个子集，任何$ S_r $中向量的线性组合显然也是$ S $中向量的线性组合。因此，$\text{Span}(S_r)$是$\text{Span}(S)$的一个子空间，即$\text{Span}(S_r) \subseteq \text{Span}(S)$。

	其次任取向量$ v \in \text{Span}(S) $，则$ v $可以表示为$ S $中某些向量的线性组合，即存在向量$ v_1, v_2, \ldots, v_k \in S $和标量$ a_1, a_2, \ldots, a_k $使得$ v = a_1 v_1 + a_2 v_2 + \ldots + a_k v_k $。

	将每个$ v_i $代入$ v $的表达式中，得到：$$v = a_1 (b_1 u_1 + \ldots + b_m u_m) + \ldots + a_k (b_1^{(k)} u_1 + \ldots + b_m^{(k)} u_m)\footnote{$b_i^{(k)} \text{表示第 } k \text{ 个向量 } v_k \text{ 对应 } S_r \text{ 中第 } i \text{ 个向量的系数}$}$$

	展开后，这是$ S_r $中向量的线性组合，因此$ v \in \text{Span}(S_r) $。从而$\text{Span}(S) \subseteq \text{Span}(S_r)$。

	综上所述，$\text{Span}(S) = \text{Span}(S_r) $。
	\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

\begin{corollary}
	向量组$S$的所有极大线性无关组$S_r$所含的向量个数相等。
\end{corollary}

\begin{proof}
	设向量组 $ S $ 中有两个极大线性无关子集，分别是：
	\begin{itemize}
		\item $ S_1 = \{ \vec{v}_1, \vec{v}_2, \dots, \vec{v}_r \} $
		\item $ S_2 = \{ \vec{w}_1, \vec{w}_2, \dots, \vec{w}_s \} $
	\end{itemize}
	我们要证明：  
	$$
	r = s
	$$
	$ S_1 $ 是线性无关组，并且在 $ S $ 中无法再添加其他向量使其仍然线性无关；所以 $ S_1 \subseteq S $，并且 $ S_2 \subseteq S $。根据定理\ref{the:Steinitz}，由于 $ S_1 \subseteq \text{Span}(S) $，而 $ S_2 \subseteq \text{Span}(S) $，并且二者都是 $ S $ 中的极大无关组 $\Longrightarrow$ 它们生成的是相同的空间（因为如果不是，就不是极大的了）。因此：$$r\le s,s\le r$$所以：$r=s$
	\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

\subsection{向量组与矩阵的秩}

上面我们讲到了极大线性无关组的所含向量个数是确定的，由此我们引出向量组的秩的概念。

\begin{definition}{向量组的秩(rank)}
	向量组$S$的极大线性无关组所含的向量个数称为这个向量组的秩(rank)，记作$\text{rank}(S)$。
\end{definition}

例如向量组$S=\left\{ (1,1,1),(1,2,1),(2,2,2) \right\}$的秩$\text{rank}(S)=2$因为它的极大线性无关组向量的数量为2。

如果我们把向量组的每一个向量竖着写成列向量，从左向右分别表示$\alpha_1,\alpha_2,\alpha_3$，那么上述的向量组$S$表示为矩阵$\mathbf{A}$即$$\mathbf{A}=\begin{pmatrix}
	1 & 1 & 2\\
	1 & 2 & 2\\
	1 & 2 & 2
\end{pmatrix}$$

\begin{definition}{列秩，行秩，矩阵的秩}
	矩阵$\mathbf{A}$的列向量组的秩称为列秩，矩阵的行向量组的秩称为行秩，矩阵的秩一般指的是矩阵的列秩，记作$r(\mathbf{A})$
\end{definition}

例如上面的矩阵$\mathbf{A}$的秩$r(\mathbf{A})=2$，下面的推论说明了矩阵的列秩等于行秩。

\begin{corollary}
	矩阵的列秩等于行秩。
\end{corollary}

\begin{proof}
	我们从线性映射的角度出发，将一个矩阵看作一个线性变换。
	$$
	T_A : \mathcal{V}(\mathbb{F}^n, \mathbb{F}^m), \quad T_A(x) = Ax
	$$
	根据定理\ref{the:important}，线性变换 $ T_A : \mathbb{F}^n \to \mathbb{F}^m $ 满足：$$\text{rank}(A) = \dim(\text{null}(T_A)) = n - \dim(\text{range} A)$$同样地，对于 $ A^T \in \mathbb{F}^{n \times m} $：$$\text{rank}(A^T) = \dim(\text{null}(A^T)) = m - \dim(\text{range} A^T)$$反求出$\text{rank}(A^T) = \text{rank}(A)$\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

\begin{corollary}
	矩阵经过初等变换，其秩不变。
\end{corollary}

此推论不作证明，下面我们会利用此推论来求解矩阵的秩：

\begin{example}
	求矩阵$\mathbf{A}=\begin{pmatrix}
		1 & 1 & 1 & 2\\
		3 & 2 & 1 & 1\\
		3 & 2 & 6 & 3\\
		8 & 6 & 9 & 8
	   \end{pmatrix}$的秩。
	   \tcblower
	   \textcolor{purple}{\textbf{解}}：将矩阵第1行乘以$-3$加到第2行可得
	   $$
	   \begin{pmatrix}
		1 & 1 & 1 & 2\\
		3 & 2 & 1 & 2\\
		3 & 2 & 6 & 2\\
		8 & 6 & 9 & 8
	   \end{pmatrix}\Longrightarrow\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		3 & 2 & 6 & 2\\
		8 & 6 & 9 & 8
	   \end{pmatrix}
	   $$将矩阵第1行乘以$-3$加到第3行可得$$\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		3 & 2 & 6 & 2\\
		8 & 6 & 9 & 8
	   \end{pmatrix}\Longrightarrow\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & -1 & 3 & 4\\
		8 & 6 & 9 & 8
	   \end{pmatrix}$$将矩阵第1行乘以$-8$加到第4行可得$$\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & -1 & 3 & 4\\
		8 & 6 & 9 & 8
	   \end{pmatrix}\Longrightarrow\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & -1 & 3 & 4\\
		0 & -2 & 1 & -8
	   \end{pmatrix}$$将矩阵第2行乘以$-1$加到第3行可得$$\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & -1 & 3 & 4\\
		0 & -2 & 1 & -8
	   \end{pmatrix}\Longrightarrow\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & 0 & 5 & 0\\
		0 & -2 & 1 & -8
	   \end{pmatrix}$$将矩阵第2行乘以$-2$加到第4行可得$$\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & 0 & 5 & 0\\
		0 & -2 & 1 & -8
	   \end{pmatrix}\Longrightarrow\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & 0 & 5 & 0\\
		0 & 0 & 5 & 0
	   \end{pmatrix}$$将矩阵第3行乘以$-1$加到第4行可得$$\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & 0 & 5 & 0\\
		0 & 0 & 5 & 0
	   \end{pmatrix}\Longrightarrow\begin{pmatrix}
		1 & 1 & 1 & 2\\
		0 & -1 & -2 & -4\\
		0 & 0 & 5 & 0\\
		0 & 0 & 0 & 0
	   \end{pmatrix}$$由此得到，$r(\mathbf{A})=3$
\end{example}

上述题例我们把原来的矩阵经过初等变换得到一个新的矩阵，这个矩阵的非零行的数量为原矩阵的秩。

\subsection{秩与维度}

根据推论\ref{cor:indep}我们可以得知，空间$V=\text{Span}(S_r)$中的向量组$S_r$满足线性无关且张成$V$，所以向量组$S_r$可以看作是空间$V$的一个基。而刻画维度的一个重要特征就是其基中向量的个数，我们不难发现，向量组的秩等于其张成空间的维度。

所以请读者区分2个不同范畴的概念，一是极大线性无关组和基，二是秩和维度，它们的前者，极大线性无关组与秩均是用来刻画一个向量组的属性，而后者，基与维度用来刻画线性空间。

现在我们回顾这个重要的定理\ref{the:important}，若使用矩阵$\mathbf{A}$表示线性映射$T$，那么该矩阵的秩$r(\mathbf{A})$可以表示映射到非零空间的维度，即$\text{dim}~\text{range}T$，它们在数量上两者相等$$r(\mathbf{A})=\text{dim}~\text{range}T$$由此，我们可以将秩替换掉$\text{dim}~\text{range}T$获得一个更加正式的定理，该名称为秩——零化度定理。

\begin{theorem}{秩——零化度定理(Rank-Nullity Theorem)}
	若$m\times n$矩阵$\mathbf{A}$表示线性映射$T:\mathcal{L}(\mathbb{F}^m,\mathbb{F}^n)$满足$$r(\mathbf{A})+\text{dim}~\text{null}T=n$$
\end{theorem}

证明过程同\ref{the:important}，由于$m\times n$矩阵$\mathbf{A}$的行秩等于列秩，其秩通常可以通过$m,n$中较小的行或列进行初等变换处理，所以其秩$r(\mathbf{A})\leq \min(m,n)$。

\section{线性方程组的解空间}

\subsection{齐次线性方程组解的结构}

在前面的节\ref{subsec:homogeneous}中我们了解到齐次线性方程组中使用 Cramer 法则研究了它解的结构，共有两种情况，分别为``有且仅有全为0解''和``有非零解''，本节我们从其系数矩阵的秩的角度来研究其解的结构。

接下来我们使用 $r(\mathbf{A})$ 表示系数矩阵 $\mathbf{A}$ 的秩，未知数的个数为$n$，考虑齐次线性方程组$$\left\{\begin{matrix} 
		a_{11}x_1+a_{12}x_2+a_{13}x_3+\cdots+a_{1n}x_n=0 \\  
		a_{21}x_1+a_{22}x_2+a_{23}x_3+\cdots+a_{2n}x_n=0 \\  
		a_{31}x_1+a_{32}x_2+a_{33}x_3+\cdots+a_{3n}x_n=0 \\
		\cdots \\
		a_{m1}x_1+a_{m2}x_2+a_{m3}x_3+\cdots+a_{mn}x_n=0
	\end{matrix}\right. $$根据矩阵乘的定义它们可写作$\mathbf{A}\mathbf{x}=\boldsymbol{0}$，其中$$\mathbf{A}=\begin{pmatrix}
		a_{11} & a_{12} & a_{13} & \cdots & a_{1n}\\
		a_{21} & a_{22} & a_{23} & \cdots & a_{2n}\\
		a_{31} & a_{32} & a_{33} & \cdots & a_{3n}\\
		\vdots & \vdots & \vdots & \ddots & \vdots\\
		a_{m1} & a_{m2} & a_{m3} & \cdots & a_{mn}
	\end{pmatrix},\mathbf{x}=\begin{pmatrix}
		x_1\\
		x_2\\
		x_3\\
		\vdots\\
		x_n
	\end{pmatrix}$$
那么根据我们研究的第一种情况，我们有如下推论：

\begin{corollary}
	若$r(\mathbf{A})\geq n$，齐次线性方程组``有且仅有全为0解''。
\end{corollary}

\begin{proof}
	设$\mathbf{A}$是一个$m \times n$的系数矩阵，对应的齐次线性方程组为$\mathbf{A}\mathbf{x} = 0$。根据矩阵$\mathbf{A}$的秩$r(\mathbf{A})$不超过其行数$m$和列数$n$中的较小值，即$r(\mathbf{A}) \leq \min\{m, n\}$。推论中给定$r(\mathbf{A}) \geq n$，因此必须满足$\min\{m, n\} \geq n$，即$m \geq n$。结合$r(\mathbf{A}) \leq n$，可得$r(\mathbf{A}) = n$。其次根据秩——零化度定理：向量$x$张成的空间的维数为$n - r(\mathbf{A})$。当$r(\mathbf{A}) = n$时，解空间的维数为$n - n = 0$，即解仅包含零向量。向量$x$张成的空间的维数为0，意味着齐次线性方程组$\mathbf{A}\mathbf{x} = 0$只有零解。因此，当系数矩阵$\mathbf{A}$的秩$r(\mathbf{A}) \geq n$时，齐次线性方程组有且仅有零解。\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

\begin{corollary}
	若$r(\mathbf{A})< n$，齐次线性方程组``有非零解''。
\end{corollary}

\begin{proof}
	证明同上\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

\subsection{解空间}

如上所示，$x$表示一个向量，若齐次线性方程组有非零解，其解一般有多组，这些解向量$x$可以张成一个解空间$\text{Span}(x)$，下面举个例子：齐次线性方程组$$\left\{\begin{matrix} 
	x_1+2x_2+3x_3=0 \\  
	x_1+3x_2+2x_3=0
\end{matrix}\right. $$其系数矩阵为$$\begin{pmatrix}
	1 & 2 & 3 \\
	1 & 3 & 2
\end{pmatrix}$$将其简化为$$\begin{pmatrix}
	1 & 2 & 3 \\
	1 & 3 & 2
\end{pmatrix}\xrightarrow{r_2-r_1} \begin{pmatrix}
	1 & 2 & 3 \\
	0 & 1 & -1
\end{pmatrix}\xrightarrow{r_1-2r_1}\begin{pmatrix}
	1 & 0 & 5 \\
	0 & 1 & -1
\end{pmatrix}$$最后还原成方程组$$\left\{\begin{matrix} 
	1x_1+0x_2+5x_3=0 \\  
	0x_1+1x_2-1x_3=0
\end{matrix}\right. $$我们令$x_3=k,k\in \mathbb{R}$其解为$x=\begin{pmatrix}
	-5k\\
	k\\
	k
\end{pmatrix}$。

如果我们把向量$x$的$k$提出，那就是$x=k(-5,1,1)$，而解向量集合构成的空间的一个基为$\left\{ \left( -5,1,1 \right) \right\}$，根据该线性方程组的解，我们有如下定义：

\begin{definition}{解空间(solution space)与基础解系(fundamental system of solutions)}
	若齐次线性方程组的系数矩阵$\mathbf{A}$和解向量$x$满足$\mathbf{A}x=\boldsymbol{0}$，那么其线性方程组所有解向量构成的集合称为解空间，基础解系为其解空间的一组基。
\end{definition}

那么根据上述的定义，我们可以得到$$\left\{\begin{matrix} 
	x_1+2x_2+3x_3=0 \\  
	x_1+3x_2+2x_3=0
\end{matrix}\right. $$的解空间为$S=k(-5,1,1),k\in \mathbb{R}$其一个基础解系$\mathcal{B}=\left\{ (-5,1,1) \right\}$。

\begin{corollary}
	基础解系的一组向量的个数等于$n-r(\mathbf{A})$，其中$n$为未知数个数，$\mathbf{A}$为系数矩阵。
\end{corollary}

\begin{proof}
	我们这里使用非严格证明，若$n-r(\mathbf{A})>0$还原为方程组的个数会比未知数个数要少，所以我们需要$n-r(\mathbf{A})$个自由变量来表示所有解。因此基础解系的一组向量的个数等于$n-r(\mathbf{A})$。\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

\begin{corollary}
	解空间是线性空间。
\end{corollary}

\begin{proof}
	要证明齐次线性方程组$\mathbf{A}\boldsymbol{x} = \boldsymbol{0}$的解空间是一个线性空间，我们需要验证解空间满足线性空间的三个核心条件：包含零向量、加法封闭性和标量乘法封闭性。
	\begin{enumerate}
		\item 零向量存在：零向量$\boldsymbol{0}$显然满足$\mathbf{A}\boldsymbol{0} = \boldsymbol{0}$，因此$\boldsymbol{0}$属于解空间。
		\item 加法封闭性：对于解空间中的任意两个向量$\boldsymbol{x}_1$和$\boldsymbol{x}_2$，有$\mathbf{A}\boldsymbol{x}_1 = \boldsymbol{0}$和$\mathbf{A}\boldsymbol{x}_2 = \boldsymbol{0}$。根据矩阵乘法的分配律，  
		$$
		\mathbf{A}(\boldsymbol{x}_1 + \boldsymbol{x}_2) = \mathbf{A}\boldsymbol{x}_1 + \mathbf{A}\boldsymbol{x}_2 = \boldsymbol{0} + \boldsymbol{0} = \boldsymbol{0}
		$$
		因此$\boldsymbol{x}_1 + \boldsymbol{x}_2$属于解空间。
		\item 标量乘法封闭性：对于任意标量$k \in \mathbb{R}$和解空间中的任意向量$\boldsymbol{x}$，有$\mathbf{A}\boldsymbol{x} = \boldsymbol{0}$。根据标量乘法与矩阵乘法的结合律，  
		$$
		\mathbf{A}(k\boldsymbol{x}) = k\mathbf{A}\boldsymbol{x} = k\boldsymbol{0} = \boldsymbol{0}
		$$
		因此$k\boldsymbol{x}$属于解空间。
	\end{enumerate}
	由于解空间满足上述三个条件，因此它是原向量空间的一个子空间，从而自身也是一个线性空间。\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

\begin{example}
	求下列线性方程组的基础解系与解空间：$$\left\{\begin{matrix} 
		x_1+2x_2+3x_3=0 \\  
		2x_1+4x_3=0 \\
		x_1+x_2+x_4=0
	\end{matrix}\right. $$
	\tcblower
	\textcolor{purple}{\textbf{解}}：系数矩阵$\mathbf{A}=\begin{pmatrix}
		1 & 2 & 3 & 0\\
		0 & 2 & 4 & 0\\
		1 & 1 & 0 & 1
	   \end{pmatrix}$经过初等变换可得$$\begin{pmatrix}
		1 & 2 & 3 & 0\\
		0 & 2 & 4 & 0\\
		1 & 1 & 0 & 1
	   \end{pmatrix}\xrightarrow{r_3-r_1}\begin{pmatrix}
		1 & 2 & 3 & 0\\
		0 & 2 & 4 & 0\\
		0 & -1 & -3 & 1
	   \end{pmatrix}\xrightarrow{r_2/2}\begin{pmatrix}
		1 & 2 & 3 & 0\\
		0 & 1 & 2 & 0\\
		0 & -1 & -3 & 1
	   \end{pmatrix}\xrightarrow{r_3+r_2}\begin{pmatrix}
		1 & 2 & 3 & 0\\
		0 & 1 & 2 & 0\\
		0 & 0 & -1 & 1
	   \end{pmatrix}$$$$\xrightarrow{r_3\times (-1)}\begin{pmatrix}
		1 & 2 & 3 & 0\\
		0 & 1 & 2 & 0\\
		0 & 0 & 1 & -1
	   \end{pmatrix}\xrightarrow{r_2-2r_3}\begin{pmatrix}
		1 & 2 & 3 & 0\\
		0 & 1 & 0 & 2\\
		0 & 0 & 1 & -1
	   \end{pmatrix}\xrightarrow{r_1-3r_3}\begin{pmatrix}
		1 & 2 & 0 & 3\\
		0 & 1 & 0 & 2\\
		0 & 0 & 1 & -1
	   \end{pmatrix}\xrightarrow{r_1-2r_2}\begin{pmatrix}
		1 & 0 & 0 & -1\\
		0 & 1 & 0 & 2\\
		0 & 0 & 1 & -1
	   \end{pmatrix}$$将其还原为线性方程组即为$$\left\{\begin{matrix} 
		x_1-x_4=0 \\  
		x_2+2x_4=0 \\
		x_3-x_4=0
	  \end{matrix}\right. $$其中$n=4,r(\mathbf{A})=3$所以自由变量的个数为$n-(\mathbf{A})=4-3=1$，其基础解系的个数也为1，故令$x_4=1$可解得$x=(1,-2,1,1)$，基础解系为$\mathcal{B}=\left\{ (1,-2,1,1) \right\}$令$k,k\in \mathbb{R}$为自由变量，所以解空间$S=k(1,-2,1,1)$
\end{example}

\begin{ascolorbox1}{思考}
	非齐次线性方程组的解向量的集合是解空间吗？
\end{ascolorbox1}

上述思考题答案为不是，具体原因见章节\ref{subsec:ascanswer}。

\subsection{非齐次线性方程组的导出组与特解}

\label{subsec:ascanswer}

上面我们描述了齐次线性方程组的解向量，以及其集合是一个解空间；那么本节我们来讲一讲非齐次线性方程组解的结构。

现在我们来看若为非齐次的线性方程组，我们把它抽象化为一个矩阵乘法$\mathbf{A}x=b$其中$x,b\in \mathbb{R}^n$，由此我们先定义什么是导出组。

\begin{definition}{导出组}
	非齐次线性方程组$\mathbf{A}x=b,x,b\in \mathbb{R}^n$的导出组为$\mathbf{A}x=\boldsymbol{0}$。
\end{definition}

实际上导出组就是将非齐次线性方程组的常数项改为零向量，变成齐次线性方程组，为了研究非齐次线性方程组解的集合，下面给出非齐次线性方程组的特解的定义：

\begin{definition}{特解}
	非齐次线性方程组$\mathbf{A}x=b$若存在$x_p$使得$\mathbf{A}x_p=b$成立，则$x_p$为该非齐次线性方程组的特解。
\end{definition}

例如下面有一个非齐次线性方程组$$\left\{\begin{matrix} 
	x_1+x_2+2x_3=2 \\  
	x_1+2x_2 = 0
\end{matrix}\right. $$的特解$x_p$可以为$(0,0,1)$也可以为$(4,-2,0)$，接下来我们根据导出组与特解的定义有如下的推论。

\begin{corollary}
	非齐次线性方程组$\mathbf{A}x=b$的所有解向量所构成的集合$S'$为其导出组$\mathbf{A}x=0$的解空间$S$加上其一个特解向量$x_p$，即$$S'=S+x_p$$
\end{corollary}

\begin{proof}
	首先，我们考虑非齐次线性方程组$\mathbf{A}x = b$的解集合$S'$和其导出组$\mathbf{A}x = 0$的解空间$S$。假设存在一个特解$x_p$使得$\mathbf{A}x_p = b$。

	\begin{enumerate}
		\item 验证$S + x_p$中的每个元素都是$\mathbf{A}x = b$的解：对于任意的$s \in S$，有$\mathbf{A}s = 0$。令$x = s + x_p$，则$\mathbf{A}(s + x_p) = \mathbf{A}s + \mathbf{A}x_p = 0 + b = b$，因此$x = s + x_p$是$\mathbf{A}x = b$的解。这说明$S + x_p$是$S'$的一个子集。
		\item 验证$S'$是$S + x_p$的子集：假设$x'$是$\mathbf{A}x = b$的任意一个解，则$\mathbf{A}x' = b$。考虑$x' - x_p$，有$\mathbf{A}(x' - x_p) = \mathbf{A}x' - \mathbf{A}x_p = b - b = 0$，因此$x' - x_p \in S$。这说明$x' = (x' - x_p) + x_p$，其中$(x' - x_p) \in S$，所以$x' \in S + x_p$。因此，$S'$是$S + x_p$的子集。
	\end{enumerate}

	综上所述，$S'$既是$S + x_p$的子集，又是它的超集，因此$S' = S + x_p$。
	\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}

由此我们可以根据上述推论来解决上面没有解决的思考题：非齐次线性方程组的解向量的集合不是解空间；

\begin{proof}
	为了证明非齐次线性方程组的解向量的集合不是解空间（线性空间），我们可以从线性空间的定义出发，验证其是否满足线性空间的条件\footnote{实际上我们只需证明一项不符合线性空间的要求即可}。

	\begin{enumerate}
		\item 零向量的存在性：非齐次线性方程组的形式为 $Ax = b$，其中 $b \neq 0$。零向量 $0$ 满足 $A0 = 0$，但由于 $b \neq 0$，显然 $0$ 不是非齐次方程组的解。因此，解集中不包含零向量，而零向量是线性空间的必要条件之一。
		\item 加法封闭性：假设 $x_1$ 和 $x_2$ 是非齐次方程组的解，即 $Ax_1 = b$ 和 $Ax_2 = b$。考虑它们的和 $x_1 + x_2$，有：
		$$
		A(x_1 + x_2) = Ax_1 + Ax_2 = b + b = 2b
		$$
		由于 $b \neq 0$，当 $2b \neq b$ 时，$x_1 + x_2$ 不是非齐次方程组的解，因此加法不封闭。
		\item 标量乘法封闭性：假设 $x$ 是非齐次方程组的解，即 $Ax = b$。考虑标量乘法 $c \cdot x$（其中 $c$ 是标量），有：
		$$
		A(c \cdot x) = c \cdot Ax = c \cdot b
		$$
		当 $c \neq 1$ 时，$c \cdot b \neq b$，因此 $c \cdot x$ 不是非齐次方程组的解，标量乘法不封闭。
	\end{enumerate}

	由于非齐次线性方程组的解集不包含零向量，并且不满足加法和标量乘法的封闭性，因此它不构成线性空间。
	\begin{flushright}
		$\square$
	\end{flushright}
\end{proof}